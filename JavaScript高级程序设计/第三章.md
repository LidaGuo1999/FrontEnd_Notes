## 第3章 基本概念

### 3.1 语法

ECMAScript（js是它的一个实现）的语法借鉴了许多C语言的语法。

- js的一切都区分大小写；

- 标识符以字母、下划线(_)或者美元符号(\$)开头，由字母、下划线、美元符号或数字组成，一般建议采用驼峰命名法。不允许关键字、保留字、true、false和null用作标识符；

- 单行注释用//，多行注释用/*  */；

- 严格模式是js定义的一种不同的解析与执行模型，某些不确定的行为将得到处理，而且对某些不安全的操作也会抛出错误。在代码顶部或者函数开头都可以指定开启严格模式，添加如下代码即可：

  ```javascript
  "use strict";	// 看起来是字符串，其实是一个编译指示。
  ```

- 语句可以以分号结尾，也可以不加分号由解析器确定结尾。但是为了可读性和安全性，建议还是分号结尾。

### 3.2 关键字和保留字

略

### 3.3 变量

- js的变量是松散类型的，可以用来保存任何类型的数据，且保存的数据类型随时可以根据变量类型更改；

- 使用var操作符定义变量，一条语句可以定义多个变量，只需要逗号隔开，如：

  ```javascript
  var message = 'hi', found = false, age = 29;
  ```

- 使用var定义的变量是局部变量，如果省略var操作符，那么定义的就是全局变量（严格模式下会抛出ReferenceError错误），如：

  ```javascript
  function test() {
  	message = 'hi';	// 全局变量
  }
  ```

### 3.4 数据类型

js中只有6种数据类型，其中5中简单类型Undefined、Null、Boolean、Number和String，1种复杂数据类型Object（本质上就是字典，即一组无序的键值对）。js不支持任何创建自定义类型的机制。

- typeof操作符（注意不是函数）用于检测变量的数据类型，返回值可能是以下几种：

  - undefined：变量类型为Undefined；
  - boolean：变量类型为Boolean；
  - string：变量类型为String；
  - number：变量类型为Number；
  - object：变量类型为Object（非函数）或Null；
  - function：变量类型为Object但其代表一个函数；

  由于typeof为操作符，因此加不加括号都可以：

  ```javascript
  // 下面两个式子等价
  alert(typeof(message));
  alert(typeof message);
  ```

  从技术上看函数是Object，不是一种数据类型，但是函数有一些特殊的属性，因此typeof对其进行区分也是必要的。

- Undefined类型只有一个值，即为undefined，使用var声明变量但是没有初始化时值就是undefined。如果对未声明（不是未初始化）的变量使用typeof，那么结果也是undefined，但是未声明的变量在其他语句中就会导致程序出错。

- Null类型只有一个值，即为null。从逻辑上看，null值表示一个空对象指针。如果定义的变量准备在将来用于保存对象，那么将其初始化为null值是一个很好的选择。同时undefined值从null派生出来的，因此它们在相等性测试中是一样的，即

  ```javascript
  alert(null == undefined); // true
  ```

- Boolean类型取值只有两个：true和false（注意都是小写）。但是它们和数字值不是一回事，true不一定等于非零，false也不一定等于0。Boolean()是一个转型函数，可以对任意的数据类型使用，值的转换规律如下表：

  | 数据类型  | 转换为true的值             | 转换为false的值 |
  | --------- | -------------------------- | --------------- |
  | Boolean   | true                       | false           |
  | String    | 任何非空字符串             | 空字符串        |
  | Number    | 任何非零数字（包括无穷大） | 0和NaN          |
  | Object    | 任何对象                   | null            |
  | Undefined | 无                         | undefined       |

- Number类型可以表示整数和浮点数，支持各种数值类型。

  - 整数中十进制整数直接输入，第一位是0的数字被处理为八进制数（前提是数字中只有0-7，否则将解释为十进制），以0x开头的为十六进制数。

  - 浮点数必须有小数点，小数点前后可以不加数字。但是注意浮点数由于精度问题，有时候相加不一定等于另一个浮点数，因此不要测试某个特定的浮点数值，比如

    ```javascript
    alert(0.1+0.2 == 0.3)	// false
    ```

  - 同样可以使用e或E来表示科学计数法，如3.7e5。

  - Number.MIN_VALUE和Number.MAX_VALUE保存着可以表示的最大和最小值，如果超出该值，那么就会被自动转换为Infinity或者-Infinity值，且这两个值将无法继续参与下一次的计算。isFinite()函数可以确定一个数值是不是有穷的。

  - NaN代表非数值（Not a Number），用于表示一个本来要返回数值的操作数未返回数值的情况，从而不会抛出错误。比如0作分母时结果为NaN。任何涉及NaN的运算都会返回NaN，且NaN与任何值都不相等，包括自己。isNaN()函数可以确定参数是否不是数值，要注意，这个函数会尝试将参数转换为数值，某些本身不是数值的数会被转换为数值，见例子：

    ```javascript
    isNaN(NaN);	// true
    isNaN(10);	// false	本身就是数字10
    isNaN("10");	// false，可以被转换为数字10
    isNaN("blue");	// true
    isNaN(true);	// false，可以被转换为数值1
    ```

    isNan()也可以用于对象，此时会首先调用对象的valueOf()方法，如果方法返回值无法被转换为数值，那么基于这个返回值再调用toString()方法，再测试返回值。其实这个过程也是js中内置函数和操作符的一般执行流程。

  - 将非数值转换为数值有以下三个函数：

    - Number()，又称转型函数，可以用于任何数据类型，规则如下：
      - 对Boolean值，将true和false分别转换为1和0；
      - 对Number值不改变；
      - 对null值，转换为0；
      - 对undefined值，转换为NaN；
      - 对String值，较为复杂，遵循规则如下：
        - 字符串可以直接解释为数值的（包括以0x开头的十六进制数，会被解释为十进制，其余的直接解释（包括整数和浮点数），但是会忽略前导零。
        - 如果字符串为空，转换为0；
        - 如果有除了上述格式之外的字符，则转换为NaN；
      - 对于对象，首先调用valueOf()方法，如果不行再调用toString()方法；
    - parseInt()，将字符串转换为整数的方法。该方法忽略前导空格，从第一个非空格字符开始分析。如果第一个字符不是数字或者负号，直接返回NaN；否则继续分析直到解析完所有后续字符或者遇到一个无效的整数字符为止。有些js引擎可以识别出各种整数格式（十进制、八进制、十六进制），但是不统一，因此建议无论如何指定第二个参数：转换时使用的基数（即进制数）。
    - parseFloat()，将字符串转换为浮点数的方法。和上述一样，从第一个非空格字符开始分析，直到结束或者遇到无效的浮点数字字符为止。注意该方法只能够识别十进制的值，因此没有基数作为第二个参数。如果待转换的字符串包含的是一个可以解析为整数的数（没有小数点，或者小数点后均为0），那么该方法会返回一个整数。

- 

